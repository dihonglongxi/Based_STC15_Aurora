C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 1   


C51 COMPILER V9.53.0.0, COMPILATION OF MODULE USART
OBJECT MODULE PLACED IN ..\ProjOut\USART.obj
COMPILER INVOKED BY: C:\Program Files\Keil\C51\BIN\C51.EXE ..\ProgSource\USART.C LARGE OPTIMIZE(8,SPEED) CODE PRINT(..\P
                    -rojList\USART.lst) OBJECT(..\ProjOut\USART.obj)

line level    source

   1          
   2          #include "USART.h"
   3          
   4          
   5          COMx_Define     COM1,COM2;
   6          u8      xdata TX1_Buffer[COM_TX1_Lenth];        //发送缓冲
   7          u8      xdata RX1_Buffer[COM_RX1_Lenth];        //接收缓冲
   8          u8      xdata TX2_Buffer[COM_TX2_Lenth];        //发送缓冲
   9          u8      xdata RX2_Buffer[COM_RX2_Lenth];        //接收缓冲
  10          
  11          u8 USART_Configuration(u8 UARTx, COMx_InitDefine *COMx)
  12          {
  13   1              u8      i;
  14   1              u32     j;
  15   1              
  16   1              if(UARTx == USART1)
  17   1              {
  18   2                      COM1.id = 1;
  19   2                      COM1.TX_read    = 0;
  20   2                      COM1.TX_write   = 0;
  21   2                      COM1.B_TX_busy  = 0;
  22   2                      COM1.RX_Cnt     = 0;
  23   2                      COM1.RX_TimeOut = 0;
  24   2                      COM1.B_RX_OK    = 0;
  25   2                      for(i=0; i<COM_TX1_Lenth; i++)  TX1_Buffer[i] = 0;
  26   2                      for(i=0; i<COM_RX1_Lenth; i++)  RX1_Buffer[i] = 0;
  27   2      
  28   2                      if(COMx->UART_Mode > UART_9bit_BRTx)    return 2;       //模式错误
  29   2                      if(COMx->UART_Polity == PolityHigh)             PS = 1; //高优先级中断
  30   2                      else                                                                    PS = 0; //低优先级中断
  31   2                      SCON = (SCON & 0x3f) | COMx->UART_Mode;
  32   2                      if((COMx->UART_Mode == UART_9bit_BRTx) ||(COMx->UART_Mode == UART_8bit_BRTx))   //可变波特率
  33   2                      {
  34   3                              j = (MAIN_Fosc / 4) / COMx->UART_BaudRate;      //按1T计算
  35   3                              if(j >= 65536UL)        return 2;       //错误
  36   3                              j = 65536UL - j;
  37   3                              if(COMx->UART_BRT_Use == BRT_Timer1)
  38   3                              {
  39   4                                      TR1 = 0;
  40   4                                      AUXR &= ~0x01;          //S1 BRT Use Timer1;
  41   4                                      TMOD &= ~(1<<6);        //Timer1 set As Timer
  42   4                                      TMOD &= ~0x30;          //Timer1_16bitAutoReload;
  43   4                                      AUXR |=  (1<<6);        //Timer1 set as 1T mode
  44   4                                      TH1 = (u8)(j>>8);
  45   4                                      TL1 = (u8)j;
  46   4                                      ET1 = 0;        //禁止中断
  47   4                                      TMOD &= ~0x40;  //定时
  48   4                                      INT_CLKO &= ~0x02;      //不输出时钟
  49   4                                      TR1  = 1;
  50   4                              }
  51   3                              else if(COMx->UART_BRT_Use == BRT_Timer2)
  52   3                              {
  53   4                                      AUXR &= ~(1<<4);        //Timer stop
  54   4                                      AUXR |= 0x01;           //S1 BRT Use Timer2;
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 2   

  55   4                                      AUXR &= ~(1<<3);        //Timer2 set As Timer
  56   4                                      AUXR |=  (1<<2);        //Timer2 set as 1T mode
  57   4                                      TH2 = (u8)(j>>8);
  58   4                                      TL2 = (u8)j;
  59   4                                      IE2  &= ~(1<<2);        //禁止中断
  60   4                                      AUXR &= ~(1<<3);        //定时
  61   4                                      AUXR |=  (1<<4);        //Timer run enable
  62   4                              }
  63   3                              else return 2;  //错误
  64   3                      }
  65   2                      else if(COMx->UART_Mode == UART_ShiftRight)
  66   2                      {
  67   3                              if(COMx->BaudRateDouble == ENABLE)      AUXR |=  (1<<5);        //固定波特率SysClk/2
  68   3                              else                                                            AUXR &= ~(1<<5);        //固定波特率SysClk/12
  69   3                      }
  70   2                      else if(COMx->UART_Mode == UART_9bit)   //固定波特率SysClk*2^SMOD/64
  71   2                      {
  72   3                              if(COMx->BaudRateDouble == ENABLE)      PCON |=  (1<<7);        //固定波特率SysClk/32
  73   3                              else                                                            PCON &= ~(1<<7);        //固定波特率SysClk/64
  74   3                      }
  75   2                      if(COMx->UART_Interrupt == ENABLE)      ES = 1; //允许中断
  76   2                      else                                                            ES = 0; //禁止中断
  77   2                      if(COMx->UART_RxEnable == ENABLE)       REN = 1;        //允许接收
  78   2                      else                                                            REN = 0;        //禁止接收
  79   2                      P_SW1 = (P_SW1 & 0x3f) | (COMx->UART_P_SW & 0xc0);      //切换IO
  80   2                      if(COMx->UART_RXD_TXD_Short == ENABLE)  PCON2 |=  (1<<4);       //内部短路RXD与TXD, 做中继, ENABLE,DISABLE
  81   2                      else                                                                    PCON2 &= ~(1<<4);
  82   2                      return  0;
  83   2              }
  84   1      
  85   1              if(UARTx == USART2)
  86   1              {
  87   2                      COM2.id = 2;
  88   2                      COM2.TX_read    = 0;
  89   2                      COM2.TX_write   = 0;
  90   2                      COM2.B_TX_busy  = 0;
  91   2                      COM2.RX_Cnt     = 0;
  92   2                      COM2.RX_TimeOut = 0;
  93   2                      COM2.B_RX_OK    = 0;
  94   2                      for(i=0; i<COM_TX2_Lenth; i++)  TX2_Buffer[i] = 0;
  95   2                      for(i=0; i<COM_RX2_Lenth; i++)  RX2_Buffer[i] = 0;
  96   2      
  97   2                      if((COMx->UART_Mode == UART_9bit_BRTx) ||(COMx->UART_Mode == UART_8bit_BRTx))   //可变波特率
  98   2                      {
  99   3                              if(COMx->UART_Polity == PolityHigh)             IP2 |=  1;      //高优先级中断
 100   3                              else                                                                    IP2 &= ~1;      //低优先级中断
 101   3                              if(COMx->UART_Mode == UART_9bit_BRTx)   S2CON |=  (1<<7);       //9bit
 102   3                              else                                                                    S2CON &= ~(1<<7);       //8bit
 103   3                              j = (MAIN_Fosc / 4) / COMx->UART_BaudRate;      //按1T计算
 104   3                              if(j >= 65536UL)        return 2;       //错误
 105   3                              j = 65536UL - j;
 106   3                              AUXR &= ~(1<<4);        //Timer stop
 107   3                              AUXR &= ~(1<<3);        //Timer2 set As Timer
 108   3                              AUXR |=  (1<<2);        //Timer2 set as 1T mode
 109   3                              TH2 = (u8)(j>>8);
 110   3                              TL2 = (u8)j;
 111   3                              IE2  &= ~(1<<2);        //禁止中断
 112   3                              AUXR |=  (1<<4);        //Timer run enable
 113   3                      }
 114   2                      else    return 2;       //模式错误
 115   2                      if(COMx->UART_Interrupt == ENABLE)      IE2   |=  1;            //允许中断
 116   2                      else                                                            IE2   &= ~1;            //禁止中断
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 3   

 117   2                      if(COMx->UART_RxEnable == ENABLE)       S2CON |=  (1<<4);       //允许接收
 118   2                      else                                                            S2CON &= ~(1<<4);       //禁止接收
 119   2                      P_SW2 = (P_SW2 & ~1) | (COMx->UART_P_SW & 0x01);        //切换IO
 120   2              }
 121   1      }
 122          
 123          
 124          /*************** 装载串口发送缓冲 *******************************/
 125          
 126          void TX1_write2buff(u8 dat)     //写入发送缓冲，指针+1
 127          {
 128   1              TX1_Buffer[COM1.TX_write] = dat;        //装发送缓冲
 129   1              if(++COM1.TX_write >= COM_TX1_Lenth)    COM1.TX_write = 0;
 130   1      
 131   1              if(COM1.B_TX_busy == 0)         //空闲
 132   1              {  
 133   2                      COM1.B_TX_busy = 1;             //标志忙
 134   2                      TI = 1;                                 //触发发送中断
 135   2              }
 136   1      }
 137          
 138          void TX2_write2buff(u8 dat)     //写入发送缓冲，指针+1
 139          {
 140   1              TX2_Buffer[COM2.TX_write] = dat;        //装发送缓冲
 141   1              if(++COM2.TX_write >= COM_TX2_Lenth)    COM2.TX_write = 0;
 142   1      
 143   1              if(COM2.B_TX_busy == 0)         //空闲
 144   1              {  
 145   2                      COM2.B_TX_busy = 1;             //标志忙
 146   2                      SET_TI2();                              //触发发送中断
 147   2              }
 148   1      }
 149          
 150          void PrintString1(u8 *puts)
 151          {
 152   1          for (; *puts != 0;  puts++)  TX1_write2buff(*puts);         //遇到停止符0结束
 153   1      }
 154          
 155          void PrintString2(u8 *puts)
 156          {
 157   1          for (; *puts != 0;  puts++)  TX2_write2buff(*puts);         //遇到停止符0结束
 158   1      }
 159          
 160          /*
 161          void COMx_write2buff(COMx_Define *COMx, u8 dat) //写入发送缓冲，指针+1
 162          {
 163                  if(COMx->id == 1)       TX1_write2buff(dat);
 164                  if(COMx->id == 2)       TX2_write2buff(dat);
 165          }
 166          
 167          void PrintString(COMx_Define *COMx, u8 *puts)
 168          {
 169              for (; *puts != 0;  puts++)  COMx_write2buff(COMx,*puts);   //遇到停止符0结束
 170          }
 171          */
 172          
 173          
 174          /********************* UART1中断函数************************/
 175          void UART1_int (void) interrupt UART1_VECTOR
 176          {
 177   1              if(RI)
 178   1              {
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 4   

 179   2                      RI = 0;
 180   2                      if(COM1.B_RX_OK == 0)
 181   2                      {
 182   3                              if(COM1.RX_Cnt >= COM_RX1_Lenth)        COM1.RX_Cnt = 0;
 183   3                              RX1_Buffer[COM1.RX_Cnt++] = SBUF;
 184   3                              COM1.RX_TimeOut = TimeOutSet1;
 185   3                      }
 186   2              }
 187   1      
 188   1              if(TI)
 189   1              {
 190   2                      TI = 0;
 191   2                      if(COM1.TX_read != COM1.TX_write)
 192   2                      {
 193   3                              SBUF = TX1_Buffer[COM1.TX_read];
 194   3                              if(++COM1.TX_read >= COM_TX1_Lenth)             COM1.TX_read = 0;
 195   3                      }
 196   2                      else    COM1.B_TX_busy = 0;
 197   2              }
 198   1      }
 199          
 200          /********************* UART2中断函数************************/
 201          void UART2_int (void) interrupt UART2_VECTOR
 202          {
 203   1              if(RI2)
 204   1              {
 205   2                      CLR_RI2();
 206   2                      if(COM2.B_RX_OK == 0)
 207   2                      {
 208   3                              if(COM2.RX_Cnt >= COM_RX2_Lenth)        COM2.RX_Cnt = 0;
 209   3                              RX2_Buffer[COM2.RX_Cnt++] = S2BUF;
 210   3                              COM2.RX_TimeOut = TimeOutSet2;
 211   3                      }
 212   2              }
 213   1      
 214   1              if(TI2)
 215   1              {
 216   2                      CLR_TI2();
 217   2                      if(COM2.TX_read != COM2.TX_write)
 218   2                      {
 219   3                              S2BUF = TX2_Buffer[COM2.TX_read];
 220   3                              if(++COM2.TX_read >= COM_TX2_Lenth)             COM2.TX_read = 0;
 221   3                      }
 222   2                      else    COM2.B_TX_busy = 0;
 223   2              }
 224   1      
 225   1      }
 226          
 227          
 228          
*** WARNING C291 IN LINE 121 OF ..\ProgSource\USART.C: not every exit path returns a value
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 5   

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION _USART_Configuration (BEGIN)
                                           ; SOURCE LINE # 11
0000 900000      R     MOV     DPTR,#COMx
0003 EB                MOV     A,R3
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EA                MOV     A,R2
0007 F0                MOVX    @DPTR,A
0008 A3                INC     DPTR
0009 E9                MOV     A,R1
000A F0                MOVX    @DPTR,A
000B 900000      R     MOV     DPTR,#UARTx
000E EF                MOV     A,R7
000F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 12
                                           ; SOURCE LINE # 16
0010 6401              XRL     A,#01H
0012 6003              JZ      $ + 5H
0014 020000      R     LJMP    ?C0001
                                           ; SOURCE LINE # 17
                                           ; SOURCE LINE # 18
0017 900000      R     MOV     DPTR,#COM1
001A 04                INC     A
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 19
001C E4                CLR     A
001D A3                INC     DPTR
001E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 20
001F A3                INC     DPTR
0020 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 21
0021 A3                INC     DPTR
0022 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 22
0023 A3                INC     DPTR
0024 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 23
0025 A3                INC     DPTR
0026 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 24
0027 A3                INC     DPTR
0028 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 25
0029 900000      R     MOV     DPTR,#i
002C F0                MOVX    @DPTR,A
002D         ?C0002:
002D 900000      R     MOV     DPTR,#i
0030 E0                MOVX    A,@DPTR
0031 FF                MOV     R7,A
0032 C3                CLR     C
0033 9480              SUBB    A,#080H
0035 5014              JNC     ?C0003
0037 7400        R     MOV     A,#LOW TX1_Buffer
0039 2F                ADD     A,R7
003A F582              MOV     DPL,A
003C E4                CLR     A
003D 3400        R     ADDC    A,#HIGH TX1_Buffer
003F F583              MOV     DPH,A
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 6   

0041 E4                CLR     A
0042 F0                MOVX    @DPTR,A
0043 900000      R     MOV     DPTR,#i
0046 E0                MOVX    A,@DPTR
0047 04                INC     A
0048 F0                MOVX    @DPTR,A
0049 80E2              SJMP    ?C0002
004B         ?C0003:
                                           ; SOURCE LINE # 26
004B E4                CLR     A
004C 900000      R     MOV     DPTR,#i
004F F0                MOVX    @DPTR,A
0050         ?C0005:
0050 900000      R     MOV     DPTR,#i
0053 E0                MOVX    A,@DPTR
0054 FF                MOV     R7,A
0055 C3                CLR     C
0056 9480              SUBB    A,#080H
0058 5014              JNC     ?C0006
005A 7400        R     MOV     A,#LOW RX1_Buffer
005C 2F                ADD     A,R7
005D F582              MOV     DPL,A
005F E4                CLR     A
0060 3400        R     ADDC    A,#HIGH RX1_Buffer
0062 F583              MOV     DPH,A
0064 E4                CLR     A
0065 F0                MOVX    @DPTR,A
0066 900000      R     MOV     DPTR,#i
0069 E0                MOVX    A,@DPTR
006A 04                INC     A
006B F0                MOVX    @DPTR,A
006C 80E2              SJMP    ?C0005
006E         ?C0006:
                                           ; SOURCE LINE # 28
006E 900000      R     MOV     DPTR,#COMx
0071 E0                MOVX    A,@DPTR
0072 FB                MOV     R3,A
0073 A3                INC     DPTR
0074 E0                MOVX    A,@DPTR
0075 FA                MOV     R2,A
0076 A3                INC     DPTR
0077 E0                MOVX    A,@DPTR
0078 F9                MOV     R1,A
0079 120000      E     LCALL   ?C?CLDPTR
007C D3                SETB    C
007D 94C0              SUBB    A,#0C0H
007F 4003              JC      ?C0008
0081 7F02              MOV     R7,#02H
0083 22                RET     
0084         ?C0008:
                                           ; SOURCE LINE # 29
0084 90000A            MOV     DPTR,#0AH
0087 120000      E     LCALL   ?C?CLDOPTR
008A B40104            CJNE    A,#01H,?C0010
008D D2BC              SETB    PS
008F 8002              SJMP    ?C0011
0091         ?C0010:
                                           ; SOURCE LINE # 30
0091 C2BC              CLR     PS
0093         ?C0011:
                                           ; SOURCE LINE # 31
0093 120000      E     LCALL   ?C?CLDPTR
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 7   

0096 FF                MOV     R7,A
0097 E598              MOV     A,SCON
0099 543F              ANL     A,#03FH
009B 4F                ORL     A,R7
009C F598              MOV     SCON,A
                                           ; SOURCE LINE # 32
009E EF                MOV     A,R7
009F 64C0              XRL     A,#0C0H
00A1 6008              JZ      ?C0013
00A3 EF                MOV     A,R7
00A4 6440              XRL     A,#040H
00A6 6003              JZ      $ + 5H
00A8 020000      R     LJMP    ?C0012
00AB         ?C0013:
                                           ; SOURCE LINE # 33
                                           ; SOURCE LINE # 34
00AB 900002            MOV     DPTR,#02H
00AE 120000      E     LCALL   ?C?LLDOPTR0
00B1 7F30              MOV     R7,#030H
00B3 7EFF              MOV     R6,#0FFH
00B5 7D66              MOV     R5,#066H
00B7 7C00              MOV     R4,#00H
00B9 120000      E     LCALL   ?C?ULDIV
00BC 900000      R     MOV     DPTR,#j
00BF 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 35
00C2 E4                CLR     A
00C3 FF                MOV     R7,A
00C4 FE                MOV     R6,A
00C5 7D01              MOV     R5,#01H
00C7 FC                MOV     R4,A
00C8 900000      R     MOV     DPTR,#j
00CB E0                MOVX    A,@DPTR
00CC F8                MOV     R0,A
00CD A3                INC     DPTR
00CE E0                MOVX    A,@DPTR
00CF F9                MOV     R1,A
00D0 A3                INC     DPTR
00D1 E0                MOVX    A,@DPTR
00D2 FA                MOV     R2,A
00D3 A3                INC     DPTR
00D4 E0                MOVX    A,@DPTR
00D5 FB                MOV     R3,A
00D6 C3                CLR     C
00D7 120000      E     LCALL   ?C?ULCMP
00DA 4003              JC      ?C0014
00DC 7F02              MOV     R7,#02H
00DE 22                RET     
00DF         ?C0014:
                                           ; SOURCE LINE # 36
00DF 900000      R     MOV     DPTR,#j
00E2 E0                MOVX    A,@DPTR
00E3 F8                MOV     R0,A
00E4 A3                INC     DPTR
00E5 E0                MOVX    A,@DPTR
00E6 F9                MOV     R1,A
00E7 A3                INC     DPTR
00E8 E0                MOVX    A,@DPTR
00E9 FA                MOV     R2,A
00EA A3                INC     DPTR
00EB E0                MOVX    A,@DPTR
00EC FB                MOV     R3,A
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 8   

00ED C3                CLR     C
00EE E4                CLR     A
00EF 9B                SUBB    A,R3
00F0 FF                MOV     R7,A
00F1 E4                CLR     A
00F2 9A                SUBB    A,R2
00F3 FE                MOV     R6,A
00F4 7401              MOV     A,#01H
00F6 99                SUBB    A,R1
00F7 FD                MOV     R5,A
00F8 E4                CLR     A
00F9 98                SUBB    A,R0
00FA FC                MOV     R4,A
00FB 900000      R     MOV     DPTR,#j
00FE 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 37
0101 900000      R     MOV     DPTR,#COMx
0104 E0                MOVX    A,@DPTR
0105 FB                MOV     R3,A
0106 A3                INC     DPTR
0107 E0                MOVX    A,@DPTR
0108 FA                MOV     R2,A
0109 A3                INC     DPTR
010A E0                MOVX    A,@DPTR
010B F9                MOV     R1,A
010C 900001            MOV     DPTR,#01H
010F 120000      E     LCALL   ?C?CLDOPTR
0112 FB                MOV     R3,A
0113 6401              XRL     A,#01H
0115 7038              JNZ     ?C0015
                                           ; SOURCE LINE # 38
                                           ; SOURCE LINE # 39
0117 C28E              CLR     TR1
                                           ; SOURCE LINE # 40
0119 538EFE            ANL     AUXR,#0FEH
                                           ; SOURCE LINE # 41
011C 5389BF            ANL     TMOD,#0BFH
                                           ; SOURCE LINE # 42
011F 5389CF            ANL     TMOD,#0CFH
                                           ; SOURCE LINE # 43
0122 438E40            ORL     AUXR,#040H
                                           ; SOURCE LINE # 44
0125 900000      R     MOV     DPTR,#j
0128 E0                MOVX    A,@DPTR
0129 FC                MOV     R4,A
012A A3                INC     DPTR
012B E0                MOVX    A,@DPTR
012C FD                MOV     R5,A
012D A3                INC     DPTR
012E E0                MOVX    A,@DPTR
012F FE                MOV     R6,A
0130 A3                INC     DPTR
0131 E0                MOVX    A,@DPTR
0132 FF                MOV     R7,A
0133 7808              MOV     R0,#08H
0135 120000      E     LCALL   ?C?ULSHR
0138 8F8D              MOV     TH1,R7
                                           ; SOURCE LINE # 45
013A 900000      R     MOV     DPTR,#j
013D A3                INC     DPTR
013E A3                INC     DPTR
013F A3                INC     DPTR
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 9   

0140 E0                MOVX    A,@DPTR
0141 F58B              MOV     TL1,A
                                           ; SOURCE LINE # 46
0143 C2AB              CLR     ET1
                                           ; SOURCE LINE # 47
0145 5389BF            ANL     TMOD,#0BFH
                                           ; SOURCE LINE # 48
0148 538FFD            ANL     INT_CLKO,#0FDH
                                           ; SOURCE LINE # 49
014B D28E              SETB    TR1
                                           ; SOURCE LINE # 50
014D 8076              SJMP    ?C0019
014F         ?C0015:
                                           ; SOURCE LINE # 51
014F EB                MOV     A,R3
0150 6402              XRL     A,#02H
0152 7035              JNZ     ?C0017
                                           ; SOURCE LINE # 52
                                           ; SOURCE LINE # 53
0154 538EEF            ANL     AUXR,#0EFH
                                           ; SOURCE LINE # 54
0157 438E01            ORL     AUXR,#01H
                                           ; SOURCE LINE # 55
015A 538EF7            ANL     AUXR,#0F7H
                                           ; SOURCE LINE # 56
015D 438E04            ORL     AUXR,#04H
                                           ; SOURCE LINE # 57
0160 900000      R     MOV     DPTR,#j
0163 E0                MOVX    A,@DPTR
0164 FC                MOV     R4,A
0165 A3                INC     DPTR
0166 E0                MOVX    A,@DPTR
0167 FD                MOV     R5,A
0168 A3                INC     DPTR
0169 E0                MOVX    A,@DPTR
016A FE                MOV     R6,A
016B A3                INC     DPTR
016C E0                MOVX    A,@DPTR
016D FF                MOV     R7,A
016E 7808              MOV     R0,#08H
0170 120000      E     LCALL   ?C?ULSHR
0173 8FD6              MOV     TH2,R7
                                           ; SOURCE LINE # 58
0175 900000      R     MOV     DPTR,#j
0178 A3                INC     DPTR
0179 A3                INC     DPTR
017A A3                INC     DPTR
017B E0                MOVX    A,@DPTR
017C F5D7              MOV     TL2,A
                                           ; SOURCE LINE # 59
017E 53AFFB            ANL     IE2,#0FBH
                                           ; SOURCE LINE # 60
0181 538EF7            ANL     AUXR,#0F7H
                                           ; SOURCE LINE # 61
0184 438E10            ORL     AUXR,#010H
                                           ; SOURCE LINE # 62
0187 803C              SJMP    ?C0019
0189         ?C0017:
                                           ; SOURCE LINE # 63
0189 7F02              MOV     R7,#02H
018B 22                RET     
                                           ; SOURCE LINE # 64
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 10  

018C         ?C0012:
                                           ; SOURCE LINE # 65
018C 900000      R     MOV     DPTR,#COMx
018F E0                MOVX    A,@DPTR
0190 FB                MOV     R3,A
0191 A3                INC     DPTR
0192 E0                MOVX    A,@DPTR
0193 FA                MOV     R2,A
0194 A3                INC     DPTR
0195 E0                MOVX    A,@DPTR
0196 F9                MOV     R1,A
0197 120000      E     LCALL   ?C?CLDPTR
019A FF                MOV     R7,A
019B 7013              JNZ     ?C0020
                                           ; SOURCE LINE # 66
                                           ; SOURCE LINE # 67
019D 900008            MOV     DPTR,#08H
01A0 120000      E     LCALL   ?C?CLDOPTR
01A3 B40105            CJNE    A,#01H,?C0021
01A6 438E20            ORL     AUXR,#020H
01A9 801A              SJMP    ?C0019
01AB         ?C0021:
                                           ; SOURCE LINE # 68
01AB 538EDF            ANL     AUXR,#0DFH
                                           ; SOURCE LINE # 69
01AE 8015              SJMP    ?C0019
01B0         ?C0020:
                                           ; SOURCE LINE # 70
01B0 EF                MOV     A,R7
01B1 B48011            CJNE    A,#080H,?C0019
                                           ; SOURCE LINE # 71
                                           ; SOURCE LINE # 72
01B4 900008            MOV     DPTR,#08H
01B7 120000      E     LCALL   ?C?CLDOPTR
01BA B40105            CJNE    A,#01H,?C0025
01BD 438780            ORL     PCON,#080H
01C0 8003              SJMP    ?C0019
01C2         ?C0025:
                                           ; SOURCE LINE # 73
01C2 53877F            ANL     PCON,#07FH
                                           ; SOURCE LINE # 74
01C5         ?C0019:
                                           ; SOURCE LINE # 75
01C5 900000      R     MOV     DPTR,#COMx
01C8 E0                MOVX    A,@DPTR
01C9 FB                MOV     R3,A
01CA A3                INC     DPTR
01CB E0                MOVX    A,@DPTR
01CC FA                MOV     R2,A
01CD A3                INC     DPTR
01CE E0                MOVX    A,@DPTR
01CF F9                MOV     R1,A
01D0 900009            MOV     DPTR,#09H
01D3 120000      E     LCALL   ?C?CLDOPTR
01D6 B40104            CJNE    A,#01H,?C0027
01D9 D2AC              SETB    ES
01DB 8002              SJMP    ?C0028
01DD         ?C0027:
                                           ; SOURCE LINE # 76
01DD C2AC              CLR     ES
01DF         ?C0028:
                                           ; SOURCE LINE # 77
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 11  

01DF 900007            MOV     DPTR,#07H
01E2 120000      E     LCALL   ?C?CLDOPTR
01E5 B40104            CJNE    A,#01H,?C0029
01E8 D29C              SETB    REN
01EA 8002              SJMP    ?C0030
01EC         ?C0029:
                                           ; SOURCE LINE # 78
01EC C29C              CLR     REN
01EE         ?C0030:
                                           ; SOURCE LINE # 79
01EE 90000B            MOV     DPTR,#0BH
01F1 120000      E     LCALL   ?C?CLDOPTR
01F4 54C0              ANL     A,#0C0H
01F6 FF                MOV     R7,A
01F7 E5A2              MOV     A,P_SW1
01F9 543F              ANL     A,#03FH
01FB 4F                ORL     A,R7
01FC F5A2              MOV     P_SW1,A
                                           ; SOURCE LINE # 80
01FE 90000C            MOV     DPTR,#0CH
0201 120000      E     LCALL   ?C?CLDOPTR
0204 B40105            CJNE    A,#01H,?C0031
0207 439710            ORL     PCON2,#010H
020A 8003              SJMP    ?C0032
020C         ?C0031:
                                           ; SOURCE LINE # 81
020C 5397EF            ANL     PCON2,#0EFH
020F         ?C0032:
                                           ; SOURCE LINE # 82
020F 7F00              MOV     R7,#00H
0211 22                RET     
                                           ; SOURCE LINE # 83
0212         ?C0001:
                                           ; SOURCE LINE # 85
0212 900000      R     MOV     DPTR,#UARTx
0215 E0                MOVX    A,@DPTR
0216 6402              XRL     A,#02H
0218 6003              JZ      $ + 5H
021A 020000      R     LJMP    ?C0009
                                           ; SOURCE LINE # 86
                                           ; SOURCE LINE # 87
021D 900000      R     MOV     DPTR,#COM2
0220 7402              MOV     A,#02H
0222 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 88
0223 E4                CLR     A
0224 A3                INC     DPTR
0225 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 89
0226 A3                INC     DPTR
0227 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 90
0228 A3                INC     DPTR
0229 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 91
022A A3                INC     DPTR
022B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 92
022C A3                INC     DPTR
022D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 93
022E A3                INC     DPTR
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 12  

022F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 94
0230 900000      R     MOV     DPTR,#i
0233 F0                MOVX    @DPTR,A
0234         ?C0034:
0234 900000      R     MOV     DPTR,#i
0237 E0                MOVX    A,@DPTR
0238 FF                MOV     R7,A
0239 C3                CLR     C
023A 9480              SUBB    A,#080H
023C 5014              JNC     ?C0035
023E 7400        R     MOV     A,#LOW TX2_Buffer
0240 2F                ADD     A,R7
0241 F582              MOV     DPL,A
0243 E4                CLR     A
0244 3400        R     ADDC    A,#HIGH TX2_Buffer
0246 F583              MOV     DPH,A
0248 E4                CLR     A
0249 F0                MOVX    @DPTR,A
024A 900000      R     MOV     DPTR,#i
024D E0                MOVX    A,@DPTR
024E 04                INC     A
024F F0                MOVX    @DPTR,A
0250 80E2              SJMP    ?C0034
0252         ?C0035:
                                           ; SOURCE LINE # 95
0252 E4                CLR     A
0253 900000      R     MOV     DPTR,#i
0256 F0                MOVX    @DPTR,A
0257         ?C0037:
0257 900000      R     MOV     DPTR,#i
025A E0                MOVX    A,@DPTR
025B FF                MOV     R7,A
025C C3                CLR     C
025D 9480              SUBB    A,#080H
025F 5014              JNC     ?C0038
0261 7400        R     MOV     A,#LOW RX2_Buffer
0263 2F                ADD     A,R7
0264 F582              MOV     DPL,A
0266 E4                CLR     A
0267 3400        R     ADDC    A,#HIGH RX2_Buffer
0269 F583              MOV     DPH,A
026B E4                CLR     A
026C F0                MOVX    @DPTR,A
026D 900000      R     MOV     DPTR,#i
0270 E0                MOVX    A,@DPTR
0271 04                INC     A
0272 F0                MOVX    @DPTR,A
0273 80E2              SJMP    ?C0037
0275         ?C0038:
                                           ; SOURCE LINE # 97
0275 900000      R     MOV     DPTR,#COMx
0278 E0                MOVX    A,@DPTR
0279 FB                MOV     R3,A
027A A3                INC     DPTR
027B E0                MOVX    A,@DPTR
027C FA                MOV     R2,A
027D A3                INC     DPTR
027E E0                MOVX    A,@DPTR
027F F9                MOV     R1,A
0280 120000      E     LCALL   ?C?CLDPTR
0283 FF                MOV     R7,A
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 13  

0284 64C0              XRL     A,#0C0H
0286 6008              JZ      ?C0041
0288 EF                MOV     A,R7
0289 6440              XRL     A,#040H
028B 6003              JZ      $ + 5H
028D 020000      R     LJMP    ?C0040
0290         ?C0041:
                                           ; SOURCE LINE # 98
                                           ; SOURCE LINE # 99
0290 90000A            MOV     DPTR,#0AH
0293 120000      E     LCALL   ?C?CLDOPTR
0296 B40105            CJNE    A,#01H,?C0042
0299 43B501            ORL     IP2,#01H
029C 8003              SJMP    ?C0043
029E         ?C0042:
                                           ; SOURCE LINE # 100
029E 53B5FE            ANL     IP2,#0FEH
02A1         ?C0043:
                                           ; SOURCE LINE # 101
02A1 120000      E     LCALL   ?C?CLDPTR
02A4 B4C005            CJNE    A,#0C0H,?C0044
02A7 439A80            ORL     S2CON,#080H
02AA 8003              SJMP    ?C0045
02AC         ?C0044:
                                           ; SOURCE LINE # 102
02AC 539A7F            ANL     S2CON,#07FH
02AF         ?C0045:
                                           ; SOURCE LINE # 103
02AF 900002            MOV     DPTR,#02H
02B2 120000      E     LCALL   ?C?LLDOPTR0
02B5 7F30              MOV     R7,#030H
02B7 7EFF              MOV     R6,#0FFH
02B9 7D66              MOV     R5,#066H
02BB 7C00              MOV     R4,#00H
02BD 120000      E     LCALL   ?C?ULDIV
02C0 900000      R     MOV     DPTR,#j
02C3 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 104
02C6 E4                CLR     A
02C7 FF                MOV     R7,A
02C8 FE                MOV     R6,A
02C9 7D01              MOV     R5,#01H
02CB FC                MOV     R4,A
02CC 900000      R     MOV     DPTR,#j
02CF E0                MOVX    A,@DPTR
02D0 F8                MOV     R0,A
02D1 A3                INC     DPTR
02D2 E0                MOVX    A,@DPTR
02D3 F9                MOV     R1,A
02D4 A3                INC     DPTR
02D5 E0                MOVX    A,@DPTR
02D6 FA                MOV     R2,A
02D7 A3                INC     DPTR
02D8 E0                MOVX    A,@DPTR
02D9 FB                MOV     R3,A
02DA C3                CLR     C
02DB 120000      E     LCALL   ?C?ULCMP
02DE 4003              JC      ?C0046
02E0 7F02              MOV     R7,#02H
02E2 22                RET     
02E3         ?C0046:
                                           ; SOURCE LINE # 105
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 14  

02E3 900000      R     MOV     DPTR,#j
02E6 E0                MOVX    A,@DPTR
02E7 F8                MOV     R0,A
02E8 A3                INC     DPTR
02E9 E0                MOVX    A,@DPTR
02EA F9                MOV     R1,A
02EB A3                INC     DPTR
02EC E0                MOVX    A,@DPTR
02ED FA                MOV     R2,A
02EE A3                INC     DPTR
02EF E0                MOVX    A,@DPTR
02F0 FB                MOV     R3,A
02F1 C3                CLR     C
02F2 E4                CLR     A
02F3 9B                SUBB    A,R3
02F4 FF                MOV     R7,A
02F5 E4                CLR     A
02F6 9A                SUBB    A,R2
02F7 FE                MOV     R6,A
02F8 7401              MOV     A,#01H
02FA 99                SUBB    A,R1
02FB FD                MOV     R5,A
02FC E4                CLR     A
02FD 98                SUBB    A,R0
02FE FC                MOV     R4,A
02FF 900000      R     MOV     DPTR,#j
0302 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 106
0305 538EEF            ANL     AUXR,#0EFH
                                           ; SOURCE LINE # 107
0308 538EF7            ANL     AUXR,#0F7H
                                           ; SOURCE LINE # 108
030B 438E04            ORL     AUXR,#04H
                                           ; SOURCE LINE # 109
030E 900000      R     MOV     DPTR,#j
0311 E0                MOVX    A,@DPTR
0312 FC                MOV     R4,A
0313 A3                INC     DPTR
0314 E0                MOVX    A,@DPTR
0315 FD                MOV     R5,A
0316 A3                INC     DPTR
0317 E0                MOVX    A,@DPTR
0318 FE                MOV     R6,A
0319 A3                INC     DPTR
031A E0                MOVX    A,@DPTR
031B FF                MOV     R7,A
031C 7808              MOV     R0,#08H
031E 120000      E     LCALL   ?C?ULSHR
0321 8FD6              MOV     TH2,R7
                                           ; SOURCE LINE # 110
0323 900000      R     MOV     DPTR,#j
0326 A3                INC     DPTR
0327 A3                INC     DPTR
0328 A3                INC     DPTR
0329 E0                MOVX    A,@DPTR
032A F5D7              MOV     TL2,A
                                           ; SOURCE LINE # 111
032C 53AFFB            ANL     IE2,#0FBH
                                           ; SOURCE LINE # 112
032F 438E10            ORL     AUXR,#010H
                                           ; SOURCE LINE # 113
0332 8003              SJMP    ?C0047
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 15  

0334         ?C0040:
                                           ; SOURCE LINE # 114
0334 7F02              MOV     R7,#02H
0336 22                RET     
0337         ?C0047:
                                           ; SOURCE LINE # 115
0337 900000      R     MOV     DPTR,#COMx
033A E0                MOVX    A,@DPTR
033B FB                MOV     R3,A
033C A3                INC     DPTR
033D E0                MOVX    A,@DPTR
033E FA                MOV     R2,A
033F A3                INC     DPTR
0340 E0                MOVX    A,@DPTR
0341 F9                MOV     R1,A
0342 900009            MOV     DPTR,#09H
0345 120000      E     LCALL   ?C?CLDOPTR
0348 B40105            CJNE    A,#01H,?C0048
034B 43AF01            ORL     IE2,#01H
034E 8003              SJMP    ?C0049
0350         ?C0048:
                                           ; SOURCE LINE # 116
0350 53AFFE            ANL     IE2,#0FEH
0353         ?C0049:
                                           ; SOURCE LINE # 117
0353 900007            MOV     DPTR,#07H
0356 120000      E     LCALL   ?C?CLDOPTR
0359 B40105            CJNE    A,#01H,?C0050
035C 439A10            ORL     S2CON,#010H
035F 8003              SJMP    ?C0051
0361         ?C0050:
                                           ; SOURCE LINE # 118
0361 539AEF            ANL     S2CON,#0EFH
0364         ?C0051:
                                           ; SOURCE LINE # 119
0364 90000B            MOV     DPTR,#0BH
0367 120000      E     LCALL   ?C?CLDOPTR
036A 5401              ANL     A,#01H
036C FF                MOV     R7,A
036D E5BA              MOV     A,P_SW2
036F 54FE              ANL     A,#0FEH
0371 4F                ORL     A,R7
0372 F5BA              MOV     P_SW2,A
                                           ; SOURCE LINE # 120
                                           ; SOURCE LINE # 121
0374         ?C0009:
0374 22                RET     
             ; FUNCTION _USART_Configuration (END)

             ; FUNCTION _TX1_write2buff (BEGIN)
                                           ; SOURCE LINE # 126
;---- Variable 'dat' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 127
                                           ; SOURCE LINE # 128
0000 900000      R     MOV     DPTR,#COM1+02H
0003 E0                MOVX    A,@DPTR
0004 2400        R     ADD     A,#LOW TX1_Buffer
0006 F582              MOV     DPL,A
0008 E4                CLR     A
0009 3400        R     ADDC    A,#HIGH TX1_Buffer
000B F583              MOV     DPH,A
000D EF                MOV     A,R7
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 16  

000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 129
000F 900000      R     MOV     DPTR,#COM1+02H
0012 E0                MOVX    A,@DPTR
0013 04                INC     A
0014 F0                MOVX    @DPTR,A
0015 C3                CLR     C
0016 9480              SUBB    A,#080H
0018 4002              JC      ?C0052
001A E4                CLR     A
001B F0                MOVX    @DPTR,A
001C         ?C0052:
                                           ; SOURCE LINE # 131
001C 900000      R     MOV     DPTR,#COM1+03H
001F E0                MOVX    A,@DPTR
0020 7004              JNZ     ?C0054
                                           ; SOURCE LINE # 132
                                           ; SOURCE LINE # 133
0022 04                INC     A
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 134
0024 D299              SETB    TI
                                           ; SOURCE LINE # 135
                                           ; SOURCE LINE # 136
0026         ?C0054:
0026 22                RET     
             ; FUNCTION _TX1_write2buff (END)

             ; FUNCTION _TX2_write2buff (BEGIN)
                                           ; SOURCE LINE # 138
;---- Variable 'dat' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 139
                                           ; SOURCE LINE # 140
0000 900000      R     MOV     DPTR,#COM2+02H
0003 E0                MOVX    A,@DPTR
0004 2400        R     ADD     A,#LOW TX2_Buffer
0006 F582              MOV     DPL,A
0008 E4                CLR     A
0009 3400        R     ADDC    A,#HIGH TX2_Buffer
000B F583              MOV     DPH,A
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 141
000F 900000      R     MOV     DPTR,#COM2+02H
0012 E0                MOVX    A,@DPTR
0013 04                INC     A
0014 F0                MOVX    @DPTR,A
0015 C3                CLR     C
0016 9480              SUBB    A,#080H
0018 4002              JC      ?C0055
001A E4                CLR     A
001B F0                MOVX    @DPTR,A
001C         ?C0055:
                                           ; SOURCE LINE # 143
001C 900000      R     MOV     DPTR,#COM2+03H
001F E0                MOVX    A,@DPTR
0020 7005              JNZ     ?C0057
                                           ; SOURCE LINE # 144
                                           ; SOURCE LINE # 145
0022 04                INC     A
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 146
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 17  

0024 439A02            ORL     S2CON,#02H
                                           ; SOURCE LINE # 147
                                           ; SOURCE LINE # 148
0027         ?C0057:
0027 22                RET     
             ; FUNCTION _TX2_write2buff (END)

             ; FUNCTION _PrintString1 (BEGIN)
                                           ; SOURCE LINE # 150
;---- Variable 'puts' assigned to Register 'R1/R2/R3' ----
                                           ; SOURCE LINE # 151
                                           ; SOURCE LINE # 152
0000         ?C0058:
0000 120000      E     LCALL   ?C?CLDPTR
0003 FF                MOV     R7,A
0004 600C              JZ      ?C0061
0006 120000      R     LCALL   _TX1_write2buff
0009 7401              MOV     A,#01H
000B 29                ADD     A,R1
000C F9                MOV     R1,A
000D E4                CLR     A
000E 3A                ADDC    A,R2
000F FA                MOV     R2,A
0010 80EE              SJMP    ?C0058
                                           ; SOURCE LINE # 153
0012         ?C0061:
0012 22                RET     
             ; FUNCTION _PrintString1 (END)

             ; FUNCTION _PrintString2 (BEGIN)
                                           ; SOURCE LINE # 155
;---- Variable 'puts' assigned to Register 'R1/R2/R3' ----
                                           ; SOURCE LINE # 156
                                           ; SOURCE LINE # 157
0000         ?C0062:
0000 120000      E     LCALL   ?C?CLDPTR
0003 FF                MOV     R7,A
0004 600C              JZ      ?C0065
0006 120000      R     LCALL   _TX2_write2buff
0009 7401              MOV     A,#01H
000B 29                ADD     A,R1
000C F9                MOV     R1,A
000D E4                CLR     A
000E 3A                ADDC    A,R2
000F FA                MOV     R2,A
0010 80EE              SJMP    ?C0062
                                           ; SOURCE LINE # 158
0012         ?C0065:
0012 22                RET     
             ; FUNCTION _PrintString2 (END)

             ; FUNCTION UART1_int (BEGIN)
0000 C0E0              PUSH    ACC
0002 C083              PUSH    DPH
0004 C082              PUSH    DPL
0006 C0D0              PUSH    PSW
0008 75D000            MOV     PSW,#00H
000B C006              PUSH    AR6
000D C007              PUSH    AR7
                                           ; SOURCE LINE # 175
                                           ; SOURCE LINE # 177
000F 30982D            JNB     RI,?C0066
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 18  

                                           ; SOURCE LINE # 178
                                           ; SOURCE LINE # 179
0012 C298              CLR     RI
                                           ; SOURCE LINE # 180
0014 900000      R     MOV     DPTR,#COM1+06H
0017 E0                MOVX    A,@DPTR
0018 7025              JNZ     ?C0066
                                           ; SOURCE LINE # 181
                                           ; SOURCE LINE # 182
001A 900000      R     MOV     DPTR,#COM1+04H
001D E0                MOVX    A,@DPTR
001E C3                CLR     C
001F 9480              SUBB    A,#080H
0021 4002              JC      ?C0068
0023 E4                CLR     A
0024 F0                MOVX    @DPTR,A
0025         ?C0068:
                                           ; SOURCE LINE # 183
0025 900000      R     MOV     DPTR,#COM1+04H
0028 E0                MOVX    A,@DPTR
0029 FF                MOV     R7,A
002A 04                INC     A
002B F0                MOVX    @DPTR,A
002C 7400        R     MOV     A,#LOW RX1_Buffer
002E 2F                ADD     A,R7
002F F582              MOV     DPL,A
0031 E4                CLR     A
0032 3400        R     ADDC    A,#HIGH RX1_Buffer
0034 F583              MOV     DPH,A
0036 E599              MOV     A,SBUF
0038 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 184
0039 900000      R     MOV     DPTR,#COM1+05H
003C 7405              MOV     A,#05H
003E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 185
                                           ; SOURCE LINE # 186
003F         ?C0066:
                                           ; SOURCE LINE # 188
003F 309930            JNB     TI,?C0073
                                           ; SOURCE LINE # 189
                                           ; SOURCE LINE # 190
0042 C299              CLR     TI
                                           ; SOURCE LINE # 191
0044 900000      R     MOV     DPTR,#COM1+02H
0047 E0                MOVX    A,@DPTR
0048 FF                MOV     R7,A
0049 900000      R     MOV     DPTR,#COM1+01H
004C E0                MOVX    A,@DPTR
004D FE                MOV     R6,A
004E 6F                XRL     A,R7
004F 601C              JZ      ?C0070
                                           ; SOURCE LINE # 192
                                           ; SOURCE LINE # 193
0051 7400        R     MOV     A,#LOW TX1_Buffer
0053 2E                ADD     A,R6
0054 F582              MOV     DPL,A
0056 E4                CLR     A
0057 3400        R     ADDC    A,#HIGH TX1_Buffer
0059 F583              MOV     DPH,A
005B E0                MOVX    A,@DPTR
005C F599              MOV     SBUF,A
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 19  

                                           ; SOURCE LINE # 194
005E 900000      R     MOV     DPTR,#COM1+01H
0061 E0                MOVX    A,@DPTR
0062 04                INC     A
0063 F0                MOVX    @DPTR,A
0064 C3                CLR     C
0065 9480              SUBB    A,#080H
0067 4009              JC      ?C0073
0069 E4                CLR     A
006A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 195
006B 8005              SJMP    ?C0073
006D         ?C0070:
                                           ; SOURCE LINE # 196
006D 900000      R     MOV     DPTR,#COM1+03H
0070 E4                CLR     A
0071 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 197
                                           ; SOURCE LINE # 198
0072         ?C0073:
0072 D007              POP     AR7
0074 D006              POP     AR6
0076 D0D0              POP     PSW
0078 D082              POP     DPL
007A D083              POP     DPH
007C D0E0              POP     ACC
007E 32                RETI    
             ; FUNCTION UART1_int (END)

             ; FUNCTION UART2_int (BEGIN)
0000 C0E0              PUSH    ACC
0002 C083              PUSH    DPH
0004 C082              PUSH    DPL
0006 C0D0              PUSH    PSW
0008 75D000            MOV     PSW,#00H
000B C006              PUSH    AR6
000D C007              PUSH    AR7
                                           ; SOURCE LINE # 201
                                           ; SOURCE LINE # 203
000F E59A              MOV     A,S2CON
0011 30E02E            JNB     ACC.0,?C0074
                                           ; SOURCE LINE # 204
                                           ; SOURCE LINE # 205
0014 539AFE            ANL     S2CON,#0FEH
                                           ; SOURCE LINE # 206
0017 900000      R     MOV     DPTR,#COM2+06H
001A E0                MOVX    A,@DPTR
001B 7025              JNZ     ?C0074
                                           ; SOURCE LINE # 207
                                           ; SOURCE LINE # 208
001D 900000      R     MOV     DPTR,#COM2+04H
0020 E0                MOVX    A,@DPTR
0021 C3                CLR     C
0022 9480              SUBB    A,#080H
0024 4002              JC      ?C0076
0026 E4                CLR     A
0027 F0                MOVX    @DPTR,A
0028         ?C0076:
                                           ; SOURCE LINE # 209
0028 900000      R     MOV     DPTR,#COM2+04H
002B E0                MOVX    A,@DPTR
002C FF                MOV     R7,A
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 20  

002D 04                INC     A
002E F0                MOVX    @DPTR,A
002F 7400        R     MOV     A,#LOW RX2_Buffer
0031 2F                ADD     A,R7
0032 F582              MOV     DPL,A
0034 E4                CLR     A
0035 3400        R     ADDC    A,#HIGH RX2_Buffer
0037 F583              MOV     DPH,A
0039 E59B              MOV     A,S2BUF
003B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 210
003C 900000      R     MOV     DPTR,#COM2+05H
003F 7405              MOV     A,#05H
0041 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 211
                                           ; SOURCE LINE # 212
0042         ?C0074:
                                           ; SOURCE LINE # 214
0042 E59A              MOV     A,S2CON
0044 30E131            JNB     ACC.1,?C0081
                                           ; SOURCE LINE # 215
                                           ; SOURCE LINE # 216
0047 539AFD            ANL     S2CON,#0FDH
                                           ; SOURCE LINE # 217
004A 900000      R     MOV     DPTR,#COM2+02H
004D E0                MOVX    A,@DPTR
004E FF                MOV     R7,A
004F 900000      R     MOV     DPTR,#COM2+01H
0052 E0                MOVX    A,@DPTR
0053 FE                MOV     R6,A
0054 6F                XRL     A,R7
0055 601C              JZ      ?C0078
                                           ; SOURCE LINE # 218
                                           ; SOURCE LINE # 219
0057 7400        R     MOV     A,#LOW TX2_Buffer
0059 2E                ADD     A,R6
005A F582              MOV     DPL,A
005C E4                CLR     A
005D 3400        R     ADDC    A,#HIGH TX2_Buffer
005F F583              MOV     DPH,A
0061 E0                MOVX    A,@DPTR
0062 F59B              MOV     S2BUF,A
                                           ; SOURCE LINE # 220
0064 900000      R     MOV     DPTR,#COM2+01H
0067 E0                MOVX    A,@DPTR
0068 04                INC     A
0069 F0                MOVX    @DPTR,A
006A C3                CLR     C
006B 9480              SUBB    A,#080H
006D 4009              JC      ?C0081
006F E4                CLR     A
0070 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 221
0071 8005              SJMP    ?C0081
0073         ?C0078:
                                           ; SOURCE LINE # 222
0073 900000      R     MOV     DPTR,#COM2+03H
0076 E4                CLR     A
0077 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 223
                                           ; SOURCE LINE # 225
0078         ?C0081:
C51 COMPILER V9.53.0.0   USART                                                             03/25/2015 15:09:06 PAGE 21  

0078 D007              POP     AR7
007A D006              POP     AR6
007C D0D0              POP     PSW
007E D082              POP     DPL
0080 D083              POP     DPH
0082 D0E0              POP     ACC
0084 32                RETI    
             ; FUNCTION UART2_int (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1262    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =    526       9
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
